<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Romantik Interaktiv Hikoya</title>
  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
      background: #0a0a0a;
      color: #fff;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 {
      color: #ff4d88;
    }
    #videoContainer {
      max-width: 900px;
      margin: 20px auto;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 0 20px rgba(255, 0, 80, 0.25);
    }
    video {
      width: 100%;
      height: auto;
      display: block;
    }
    #choices {
      margin-top: 18px;
      display: none;
    }
    button {
      background: #ff2e63;
      color: #fff;
      padding: 12px 20px;
      margin: 8px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 16px;
      transition: transform 0.2s;
    }
    button:hover {
      transform: scale(1.04);
    }
    #errorMessage {
      color: #ff4d88;
      font-style: italic;
      display: none;
    }
  </style>
</head>
<body>
  <h1>Romantik Interaktiv Hikoya</h1>
  <p>Har bir tanlov voqeani o'zgartiradi â€” boshlash uchun video tugashini kuting. (Endi haqiqiy romantik sevgi videolari!)</p>
  <div id="errorMessage">Video yuklanmadi. Iltimos, sahifani qayta yuklang yoki internetni tekshiring.</div>
  <div id="videoContainer">
    <video id="gameVideo" controls playsinline></video>
  </div>
  <div id="choices"></div>
  <script>
    // Haqiqiy romantik videolar (Pixabay CDN, bepul va real):
    const nodes = {
      start: { 
        url: "https://cdn.pixabay.com/video/2019/01/04/20454-309694522_large.mp4", 
        text: "Uchrashuv kechasi. U sizga kulib qarab turibdi.", 
        choices: [
          { text: "Tabassum bilan qarshi olish", next: "scene1" },
          { text: "Hazil qilib gap boshlash", next: "scene2" }
        ]
      },
      scene1: { 
        url: "https://cdn.pixabay.com/video/2020/08/25/48069-451432123_large.mp4", 
        text: "U sizga yaqinlashadi.", 
        choices: [
          { text: "Uning qo'lidan ushlash", next: "scene3" },
          { text: "Ko'zlariga qarash", next: "scene4" }
        ]
      },
      scene2: { 
        url: "https://cdn.pixabay.com/video/2021/07/30/83281-584710664_large.mp4", 
        text: "Kayfiyat ko'tarildi.", 
        choices: [
          { text: "Birgalikda yurishni taklif qilish", next: "scene3" },
          { text: "Hazilni davom ettirish", next: "scene4" }
        ]
      },
      scene3: { 
        url: "https://cdn.pixabay.com/video/2021/04/13/70940-536644186_large.mp4", 
        text: "U qo'lingizni ushladi.", 
        choices: [
          { text: "Sevgi izhor qilish", next: "ending_kiss" },
          { text: "Uning yuzidan silash", next: "ending_soft" }
        ]
      },
      scene4: { 
        url: "https://cdn.pixabay.com/video/2020/06/16/42189-429661428_large.mp4", 
        text: "Samimiy atmosfera.", 
        choices: [
          { text: "Qo'shiq aytish", next: "ending_music" },
          { text: "Yaqinlashish", next: "ending_kiss" }
        ]
      },
      ending_kiss: { 
        url: "https://cdn.pixabay.com/video/2021/07/30/83281-584710664_large.mp4", 
        text: "Lablar uchrashdi. Romantik yakun.", 
        choices: [] 
      },
      ending_soft: { 
        url: "https://cdn.pixabay.com/video/2019/01/04/20454-309694522_large.mp4", 
        text: "Muloyim yakun.", 
        choices: [] 
      },
      ending_music: { 
        url: "https://cdn.pixabay.com/video/2020/08/25/48069-451432123_large.mp4", 
        text: "U qo'shig'ingizni yoqtirdi.", 
        choices: [] 
      }
    };

    const video = document.getElementById("gameVideo");
    const choicesDiv = document.getElementById("choices");
    const errorDiv = document.getElementById("errorMessage");

    function loadNode(id) {
      const node = nodes[id];
      if (!node) {
        showError("Node topilmadi: " + id);
        return;
      }
      video.src = node.url;
      video.load();
      video.play().catch((e) => {
        console.log("Avtoplay bloklandi: ", e);
      });
      video.onloadeddata = () => {
        errorDiv.style.display = "none";
      };
      video.onerror = () => {
        showError("Video yuklanmadi: " + node.url);
      };
      if (node.choices.length > 0) {
        video.onended = () => showChoices(node);
      } else {
        choicesDiv.style.display = "none";
        video.onended = null;
        video.onended = () => {
          choicesDiv.innerHTML = `<p style="font-size:18px;margin-bottom:10px">${node.text}</p>`;
          choicesDiv.style.display = "block";
        };
      }
    }

    function showChoices(node) {
      choicesDiv.innerHTML = `<p style="font-size:18px;margin-bottom:10px">${node.text}</p>`;
      choicesDiv.style.display = "block";
      while (choicesDiv.children.length > 1) {
        choicesDiv.removeChild(choicesDiv.lastChild);
      }
      node.choices.forEach((ch) => {
        const b = document.createElement("button");
        b.textContent = ch.text;
        b.onclick = () => {
          choicesDiv.style.display = "none";
          loadNode(ch.next);
        };
        choicesDiv.appendChild(b);
      });
    }

    function showError(msg) {
      errorDiv.textContent = msg;
      errorDiv.style.display = "block";
    }

    // Boshlash
    loadNode("start");
  </script>
</body>
</html>
